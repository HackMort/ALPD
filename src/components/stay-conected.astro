<div class="modal" id="modal" style="display: none;">
  <div class="stay-connected">
    <div class="stay-connected__wrapper">
      <h2 class="stay-connected__title">
        STAY CONNECTED
      </h2>
      <p class="stay-connected__text">
        Sign up for the latest news and information about hypophosphatasia
        and/or be connected with your local Alexion representative.
      </p>
      <p class="stay-connected__indication">*Indicates required field.</p>

      <form class="form" novalidate>
        <div class="form__controls">
          <div class="block">
            <div
              class="form__control"
              data-touched="false"
              data-required="true"
              data-is-valid="false"
            >
              <input
                autocomplete="given-name"
                class="form__control-input stayinput"
                type="text"
                id="first-name"
                name="first-name"
                placeholder="*First Name"
                required
                aria-required="true"
                pattern="^[a-zA-Z.'\\- ]{1,50}$"
                onblur="validateFormControl(event)"
                onchange="validateFormControl(event)"
              />
              <p class="form__control-error">Please enter first name</p>
            </div>

            <div
              class="form__control"
              data-touched="false"
              data-required="true"
              data-is-valid="false"
            >
              <input
                autocomplete="additional-name"
                class="form__control-input stayinput"
                type="text"
                id="last-name"
                name="last-name"
                placeholder="*Last Name"
                required
                aria-required="true"
                pattern="^[a-zA-Z.'\\- ]{1,50}$"
                onblur="validateFormControl(event)"
                onchange="validateFormControl(event)"
              />
              <p class="form__control-error">Please enter last name</p>
            </div>
          </div>

          <div class="block">
            <div
              class="form__control"
              data-touched="false"
              data-required="true"
              data-is-valid="false"
            >
              <div class="form__control-input">
                <select
                  id="state"
                  name="state"
                  class="form__control-select stayinput"
                  aria-placeholder="*State"
                  required
                  aria-required="true"
                  onblur="validateFormControl(event)"
                  onchange="validateFormControl(event)"
                >
                  <option value="" selected>*State</option>
                  <option value="AL">Alabama</option>
                  <option value="AK">Alaska</option>
                  <option value="AZ">Arizona</option>
                  <option value="AR">Arkansas</option>
                  <option value="CA">California</option>
                  <option value="CO">Colorado</option>
                  <option value="CT">Connecticut</option>
                  <option value="DE">Delaware</option>
                  <option value="DC">District Of Columbia</option>
                  <option value="FL">Florida</option>
                  <option value="GA">Georgia</option>
                  <option value="HI">Hawaii</option>
                  <option value="ID">Idaho</option>
                  <option value="IL">Illinois</option>
                  <option value="IN">Indiana</option>
                  <option value="IA">Iowa</option>
                  <option value="KS">Kansas</option>
                  <option value="KY">Kentucky</option>
                  <option value="LA">Louisiana</option>
                  <option value="ME">Maine</option>
                  <option value="MD">Maryland</option>
                  <option value="MA">Massachusetts</option>
                  <option value="MI">Michigan</option>
                  <option value="MN">Minnesota</option>
                  <option value="MS">Mississippi</option>
                  <option value="MO">Missouri</option>
                  <option value="MT">Montana</option>
                  <option value="NE">Nebraska</option>
                  <option value="NV">Nevada</option>
                  <option value="NH">New Hampshire</option>
                  <option value="NJ">New Jersey</option>
                  <option value="NM">New Mexico</option>
                  <option value="NY">New York</option>
                  <option value="NC">North Carolina</option>
                  <option value="ND">North Dakota</option>
                  <option value="OH">Ohio</option>
                  <option value="OK">Oklahoma</option>
                  <option value="OR">Oregon</option>
                  <option value="PA">Pennsylvania</option>
                  <option value="RI">Rhode Island</option>
                  <option value="SC">South Carolina</option>
                  <option value="SD">South Dakota</option>
                  <option value="TN">Tennessee</option>
                  <option value="TX">Texas</option>
                  <option value="UT">Utah</option>
                  <option value="VT">Vermont</option>
                  <option value="VA">Virginia</option>
                  <option value="WA">Washington</option>
                  <option value="WV">West Virginia</option>
                  <option value="WI">Wisconsin</option>
                  <option value="WY">Wyoming</option>
                </select>
              </div>
              <p class="form__control-error">Plase select a state</p>
            </div>

            <div
              class="form__control"
              data-touched="false"
              data-required="true"
              data-is-valid="false"
            >
              <input
                autocomplete="postal-code"
                class="form__control-input stayinput"
                type="text"
                id="zip-code"
                name="zip-code"
                placeholder="*ZIP Code"
                required
                aria-required="true"
                pattern="^[0-9]+"
                onblur="validateFormControl(event)"
                onchange="validateFormControl(event)"
              />
              <p class="form__control-error">Please enter ZIP code</p>
            </div>
          </div>

          <div class="block">
            <div
              class="form__control"
              data-touched="false"
              data-required="false"
              data-is-valid="true"
            >
              <input
                class="form__control-input stayinput"
                type="text"
                id="npi-number"
                name="npi-number"
                placeholder="NPI Number"
                aria-required="false"
                pattern="^[0-9]+"
                onblur="validateFormControl(event)"
                onchange="validateFormControl(event)"
              />
            </div>

            <div
              class="form__control"
              data-touched="false"
              data-required="true"
              data-is-valid="false"
            >
              <div class="form__control-input">
                <select
                  id="specialty"
                  name="specialty"
                  class="form__control-select stayinput"
                  aria-placeholder="*Specialty"
                  required
                  aria-required="true"
                  onblur="validateFormControl(event)"
                  onchange="validateFormControl(event)"
                >
                  <option value="" selected>*Specialty</option>
                  <option value="Dentistry">Dentistry</option>
                  <option value="Endocrinology">Endocrinology</option>
                  <option value="Genetics">Genetics</option>
                  <option value="Neonatology">Neonatology</option>
                  <option value="Neurology">Neurology</option>
                  <option value="Nurse Practitioner/Physician Assistant"
                    >Nurse Practitioner/Physician Assistant</option
                  >
                  <option value="Orthopedics">Orthopedics</option>
                  <option value="Pediatrics">Pediatrics</option>
                  <option value="Primary Care/Internal Medicine"
                    >Primary Care/Internal Medicine</option
                  >
                  <option value="Rheumatology">Rheumatology</option>
                  <option value="Other healthcare professional"
                    >Other healthcare professional</option
                  >
                  <option value="Other non-healthcare professional"
                    >Other non-healthcare professional</option
                  >
                </select>
              </div>
              <p class="form__control-error">Plase select a specialty</p>
            </div>
          </div>

          <div
            class="form__control"
            data-touched="false"
            data-required="true"
            data-is-valid="false"
          >
            <input
              autocomplete="email"
              class="form__control-input stayinput"
              type="email"
              id="email"
              name="email"
              placeholder="*Email Address"
              required
              aria-required="true"
              pattern="^[a-zA-Z0-9._\\-]{1,100}@[a-zA-Z0-9]+\\.[a-zA-Z]{2,10}$"
              onblur="validateFormControl(event)"
              onchange="validateFormControl(event)"
            />
            <p class="form__control-error" id="custom-error">
              Please enter email address
            </p>
          </div>
          <div
            class="form__control"
            data-touched="false"
            data-required="false"
            data-is-valid="true"
          >
            <div
              class="form__control-checkbox form__control-checkbox--last red-check"
            >
              <input
                id="terms-and-conditions"
                type="checkbox"
                name="terms-and-conditions"
                aria-required="false"
                onblur="validateFormControl(event)"
                onchange="validateFormControl(event)"
              />
              <label class="form__control-label" for="terms-and-conditions">
                I'd like to connect with my local Alexion representative.
              </label>
            </div>
          </div>

          <div
            class="form__control"
            data-touched="false"
            data-required="true"
            data-is-valid="false"
          >
            <div
              class="form__control-checkbox form__control-checkbox--last second-check"
            >
              <input
                id="terms-and-conditions2"
                type="checkbox"
                name="terms-and-conditions"
                aria-required="true"
                onblur="validateFormControl(event)"
                onchange="validateFormControl(event)"
              />
              <label class="form__control-label" for="terms-and-conditions2">
                <!-- By checking this box and submitting this form, I give <a
                  href="https://alexion.com/Legal#privacynotice%5D"
                  target="_blank">Alexion</a
                > permission to contact me for commercial purposes or otherwise provide
                me with information about Alexion's products, services, programs,
                market research, or other topics of interest that Alexion thinks
                may interest me. -->
                By checking this box and submitting this form, I give Alexion permission to provide promotional information to me or otherwise contact me about Alexion products, services, programs, or other topics that Alexion thinks may interest me.
              </label>
            </div>
            <p class="form__control-error" id="custom-error2">Please select the checkbox</p> 
          </div>

          <p class="request-a-rep__terms-text">
            By clicking Submit, I agree to the <a
              href="https://alexion.com/Legal#termsofuse"
              target="_blank">Terms & Conditions</a
            > and <a
              href="https://alexion.com/Legal#privacynotice"
              target="_blank">Privacy Notice</a
            >.
          </p>
        </div>
        <div class="button button--primary">
          <input
            type="submit"
            value="Submit"
            onclick="validateFormOnSubmit(event)"
          />
        </div>
      </form>
    </div>
    <div class="ty-message" style="display: none;">
      <h2 class="stay-connected__title">
        Thank you for signing up!
      </h2>
      <p style="text-align: center;">Your'e one step closer to catching HPP! Keep your eyes peeled for more news and information.</p>
    </div>

    <!-- absolute elements of the stay connected modal -->
    <picture class="absolute-item">
      <source
        media="(min-width: 740px)"
        srcset="/assets/images/modal-bottom-desktop.png"
      />
      <source
        media="(min-width: 200px)"
        srcset="/assets/images/modal-bottom-mobile.png"
      />
      <img src="/assets/images/modal-bottom-mobile.png" alt="" />
    </picture>

    <button class="modal__close" data-dismiss="modal" aria-label="Close modal">
      x
    </button>

    <div class="red-string absolute-item"></div>
    <div class="red-string-2 absolute-item"></div>
    <!-- absolute elements of the stay connected modal -->
  </div>
</div>

<script>
  import { Fancybox } from "@fancyapps/ui";

  const connectedModalLinks = document.querySelectorAll(".connected-modal");

  if (connectedModalLinks && connectedModalLinks.length > 0) {
    connectedModalLinks.forEach((link) => {
      link.addEventListener("click", (e) => {
        e.preventDefault();

        let instance: Fancybox;

        const modal = document.querySelector("#modal");
        const errorLabel = modal.querySelectorAll('p[class ="form__control-error"]');
        const modalClose = modal.querySelector(".modal__close");
        const button = modal.querySelector(".button");
        const inputs = document.querySelectorAll('.stayinput');
        const absolutes = document.querySelectorAll('.absolute-item');
        const check = document.querySelector('#terms-and-conditions2');
        const check2 = document.querySelector('#terms-and-conditions');
        const stayDisplay = document.querySelector(".stay-connected__wrapper");
        const stay = document.querySelector(".stay-connected");
        const tymsg = document.querySelector(".ty-message");

        modalClose.addEventListener("click", () => {
          instance.close();
        });

        button.addEventListener("click", (e) => {
        e.preventDefault();
        for(let i=0;i<inputs.length;i++){
          if(inputs[i].value === ''){
            
            errorLabel[i].style.display = 'block';
          }else{
            errorLabel[i].style.display = 'none';
          }
        }
        if(check.checked != true ){
          errorLabel[6].style.display = 'block';
        }else{
          errorLabel[6].style.display = 'none';
        }
        if(inputs[6].value === '' ){
          errorLabel[5].style.display = 'block';
        }else{
          errorLabel[5].style.display = 'none';
        }
        if(inputs[5].value === '' ){
          errorLabel[4].style.display = 'block';
        }else{
          errorLabel[4].style.display = 'none';
        }

            if(inputs[0].value!='' &&inputs[1].value!='' && inputs[2].value!='' && inputs[3].value!='' && inputs[5].value!='' && check.checked===true){
              for(let item of absolutes){
                item.style.display = 'none';
              }
              stay.style.backgroundImage = 'url(/assets/images/alp-calculator-bg-mobile.png)';
              stayDisplay.style.display = 'none';
              tymsg.style.display = 'block';
            }
        });

        instance = new Fancybox([{ src: "modal" }], {
          autoFocus: true,
          defaultType: "inline",
          placeFocusBack: true,
          trapFocus: true,
          closeButton: false,
          dragToClose: false,
          on: {
                            close: () => {
                            errorLabel.forEach((label)=>(label.style.display = 'none'))
                            inputs.forEach((input)=>(input.value = ''))
                            setTimeout(()=>{
                              stayDisplay.style.display = 'block';  
                              tymsg.style.display = 'none';  
                              check.checked = false;
                              check2.checked = false;
                              for(let item of absolutes){
                                item.style.display = 'block';
                              }  
                            },100)
                            },
                }
        });
      });
    });
  }
</script>
